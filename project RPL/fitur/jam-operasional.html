<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jam Operasional - Klinik Unsri</title>
    <link rel="stylesheet" href="jam-operasional.css">
</head>
<body>
    <div class="container">
        <nav class="top-nav">
            <a href="../home.html" class="top-nav-item">
                <div class="top-nav-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                    </svg>
                </div>
                <span class="top-nav-label">Beranda</span>
            </a>
            <a href="../user/profile.html" class="top-nav-item">
                <div class="top-nav-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </div>
                <span class="top-nav-label">Profil</span>
            </a>
            <a href="../user/riwayat.html" class="top-nav-item">
                <div class="top-nav-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                    </svg>
                </div>
                <span class="top-nav-label">Riwayat</span>
            </a>
        </nav>

        <div class="header">
            <a href="../home.html" class="back-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
                Kembali
            </a>
            <h1 class="page-title">Jam Operasional</h1>
        </div>

        <div class="content" id="scheduleContainer">
            <p style="text-align:center; margin-top: 50px;">Memuat jadwal...</p>
        </div>
    </div>

    <script>
        async function loadJamOperasional() {
            try {
                // Fetch data from the same API used by Admin
                const response = await fetch('http://localhost:3000/users/jam');
                const result = await response.json();
                const data = result.data;

                const container = document.getElementById('scheduleContainer');
                container.innerHTML = ""; 

                // Separate data by branch
                const indralaya = data.filter(item => item.cabang === 'Indralaya');
                const palembang = data.filter(item => item.cabang === 'Palembang');

                // Helper function to create HTML for each section
                function renderSection(title, items) {
                    // Sort days correctly
                    const daysOrder = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu'];
                    items.sort((a, b) => daysOrder.indexOf(a.hari) - daysOrder.indexOf(b.hari));

                    let html = `<div class="cabang-section"><h2 class="cabang-title">${title}</h2><div class="schedule-list">`;
                    
                    items.forEach(item => {
                        html += `
                            <div class="schedule-item">
                                <span class="day">${item.hari}</span>
                                <span class="time">${item.jam}</span>
                            </div>
                        `;
                    });
                    
                    html += `</div></div>`;
                    return html;
                }

                container.innerHTML += renderSection("Cabang Indralaya", indralaya);
                container.innerHTML += renderSection("Cabang Palembang", palembang);

            } catch (error) {
                console.error(error);
                document.getElementById('scheduleContainer').innerHTML = 
                    '<p style="text-align:center; color:red;">Gagal memuat data.</p>';
            }
        }

        // Run immediately
        loadJamOperasional();
    </script>
</body>
</html>